# sglang-jax.sky.yaml
resources:
  accelerators: tpu-v6e-1
  accelerator_args:
    tpu_vm: True
    runtime_version: v2-alpha-tpuv6e

# file_mounts:
#     /home/gcpuser/sky_workdir/sglang-jax: .
run: |
  rm -rf bonsai
  git clone https://github.com/primatrix/bonsai
  cd bonsai && git checkout test-wan
  uv venv --python 3.12
  source .venv/bin/activate
  uv pip install -e .
  uv pip install -r requirements.txt
  cd bonsai/models/wan2/tests
  python run_model.py

cd sky_workdir/bonsai
git fetch origin
git checkout origin/feat/wan-denoise
source .venv/bin/activate
cd bonsai/models/wan2/tests
python test_vae_output.py

